<!doctype html>
<html>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<link rel='stylesheet' href='style.css'>
</head>
<body>
<header id='header'>
<button id='toggle-sidebar' aria-label='Toggle Sidebar'>â˜°</button>
<h1>Examples</h1>
</header>
<main id='main'>
<section id='s0'>
<h2> <code>cat</code></h2>
<p>
The UNIX <code>cat</code> coreutil.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># cat.bs</span>

<span class='keyword'>var</span> code = <span class='constant'>0</span>;

<span class='keyword'>for</span> i <span class='keyword'>in</span> <span class='constant'>1</span>, <span class='keyword'>len</span>(os.<span class='field'>args</span>) {
    <span class='keyword'>var</span> path = os.<span class='field'>args</span>[i];
    <span class='keyword'>var</span> f = io.<span class='field'>Reader</span>(path);
    <span class='keyword'>if</span> !f {
        io.<span class='field'>eprintln</span>(<span class='string'>"Error: could not read file '</span><span class='escape'>\</span><span class='escape'>(</span>path<span class='escape'>)</span><span class='string'>'"</span>);
        code = <span class='constant'>1</span>;
        <span class='keyword'>continue</span>;
    }

    io.<span class='field'>print</span>(f.<span class='field'>read</span>());
    f.<span class='field'>close</span>();
}

os.<span class='field'>exit</span>(code);
</pre>
</pre>
</div>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>bs cat.bs cat.bs <span class='comment'># Poor man's quine</span>
var code = 0;

for i in 1, len(os.args) {
    var path = os.args[i];
    var f = io.Reader(path);
    if !f {
        io.eprintln("Error: could not read file '\(path)'");
        code = 1;
        continue;
    }

    io.print(f.read());

    f.close();
}

os.exit(code);
</pre>
</div>
</section>
<section id='s1'>
<h2> <code>grep</code></h2>
<p>
The UNIX <code>grep</code> coreutil.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># grep.bs</span>

<span class='keyword'>fn</span> <span class='function'>grep</span>(f, path, pattern) {
    <span class='keyword'>var</span> row = <span class='constant'>0</span>;
    <span class='keyword'>while</span> !f.<span class='field'>eof</span>() {
        <span class='keyword'>var</span> line = f.<span class='field'>readln</span>();

        <span class='keyword'>var</span> col = line.<span class='field'>find</span>(pattern);
        <span class='keyword'>if</span> col {
            io.<span class='field'>println</span>(<span class='string'>"</span><span class='escape'>\</span><span class='escape'>(</span>path<span class='escape'>)</span><span class='string'>:</span><span class='escape'>\</span><span class='escape'>(</span>row + <span class='constant'>1</span><span class='escape'>)</span><span class='string'>:</span><span class='escape'>\</span><span class='escape'>(</span>col + <span class='constant'>1</span><span class='escape'>)</span><span class='string'>: </span><span class='escape'>\</span><span class='escape'>(</span>line<span class='escape'>)</span><span class='string'>"</span>);
        }

        row += <span class='constant'>1</span>;
    }
}

<span class='keyword'>if</span> <span class='keyword'>len</span>(os.<span class='field'>args</span>) &lt; <span class='constant'>2</span> {
    io.<span class='field'>eprintln</span>(<span class='string'>"Usage: </span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>0</span>]<span class='escape'>)</span><span class='string'> &lt;pattern&gt; [file...]"</span>);
    io.<span class='field'>eprintln</span>(<span class='string'>"Error: pattern not provided"</span>);
    os.<span class='field'>exit</span>(<span class='constant'>1</span>);
}

<span class='keyword'>var</span> pattern = Regex(os.<span class='field'>args</span>[<span class='constant'>1</span>]);
<span class='keyword'>if</span> !pattern {
    io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid pattern"</span>);
    os.<span class='field'>exit</span>(<span class='constant'>1</span>);
}

<span class='keyword'>if</span> <span class='keyword'>len</span>(os.<span class='field'>args</span>) == <span class='constant'>2</span> {
    <span class='keyword'>return</span> grep(io.<span class='field'>stdin</span>, <span class='string'>"&lt;stdin&gt;"</span>, pattern);
}

<span class='keyword'>var</span> code = <span class='constant'>0</span>;

<span class='keyword'>for</span> i <span class='keyword'>in</span> <span class='constant'>2</span>, <span class='keyword'>len</span>(os.<span class='field'>args</span>) {
    <span class='keyword'>var</span> path = os.<span class='field'>args</span>[i];

    <span class='keyword'>var</span> f = io.<span class='field'>Reader</span>(path);
    <span class='keyword'>if</span> !f {
        io.<span class='field'>println</span>(<span class='string'>"Error: could not open file '</span><span class='escape'>\</span><span class='escape'>(</span>path<span class='escape'>)</span><span class='string'>'"</span>);
        code = <span class='constant'>1</span>;
        <span class='keyword'>continue</span>;
    }

    grep(f, path, pattern);
    f.<span class='field'>close</span>();
}

os.<span class='field'>exit</span>(code);
</pre>
</pre>
</div>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>bs grep.bs '\.[A-z]+\(' grep.bs
grep.bs:3:13:     while !f.eof() {
grep.bs:4:21:         var line = f.readln();
grep.bs:6:23:         var col = line.find(pattern);
grep.bs:8:15:             io.println("\(path):\(row + 1):\(col + 1): \(line)");
grep.bs:14:6:     f.close();
grep.bs:18:7:     io.eprintln("Usage: \(os.args[0]) &lt;pattern&gt; [file...]");
grep.bs:19:7:     io.eprintln("Error: pattern not provided");
grep.bs:20:7:     os.exit(1);
grep.bs:25:7:     io.eprintln("Error: invalid pattern");
grep.bs:26:7:     os.exit(1);
grep.bs:38:15:     var f = io.Reader(path);
grep.bs:40:11:         io.println("Error: could not open file '\(path)'");
grep.bs:48:3: os.exit(code);

<span class='constant'>$ </span>cat grep.bs | bs grep.bs '\.[A-z]+\(' <span class='comment'># DON'T CAT INTO GREP!!!</span>
&lt;stdin&gt;:3:13:     while !f.eof() {
&lt;stdin&gt;:4:21:         var line = f.readln();
&lt;stdin&gt;:6:23:         var col = line.find(pattern);
&lt;stdin&gt;:8:15:             io.println("\(path):\(row + 1):\(col + 1): \(line)");
&lt;stdin&gt;:16:7:     io.eprintln("Usage: \(os.args[0]) &lt;pattern&gt; [file...]");
&lt;stdin&gt;:17:7:     io.eprintln("Error: pattern not provided");
&lt;stdin&gt;:18:7:     os.exit(1);
&lt;stdin&gt;:23:7:     io.eprintln("Error: invalid pattern");
&lt;stdin&gt;:24:7:     os.exit(1);
&lt;stdin&gt;:36:15:     var f = io.Reader(path);
&lt;stdin&gt;:38:11:         io.println("Error: could not open file '\(path)'");
&lt;stdin&gt;:44:6:     f.close();
&lt;stdin&gt;:47:3: os.exit(code);
</pre>
</div>
</section>
<section id='s2'>
<h2> Shell</h2>
<p>
A simple UNIX shell.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># shell.bs</span>

<span class='keyword'>var</span> home = os.<span class='field'>getenv</span>(<span class='string'>"HOME"</span>);

<span class='comment'># Return a pretty current working directory</span>
<span class='keyword'>fn</span> <span class='function'>pwd</span>() {
    <span class='keyword'>var</span> cwd = os.<span class='field'>getcwd</span>();
    <span class='keyword'>if</span> cwd.<span class='field'>prefix</span>(home) {
        <span class='keyword'>return</span> <span class='string'>"~"</span> ++ cwd.<span class='field'>slice</span>(<span class='keyword'>len</span>(home));
    }

    <span class='keyword'>return</span> cwd;
}

<span class='comment'># Rawdogging shell lexing with regex any%</span>
<span class='keyword'>var</span> delim = Regex(<span class='string'>"[ </span><span class='escape'>\n</span><span class='string'></span><span class='escape'>\t</span><span class='string'>]+"</span>);

<span class='comment'># Previous working directory</span>
<span class='keyword'>var</span> previous = <span class='constant'>nil</span>;

<span class='keyword'>while</span> !io.<span class='field'>stdin</span>.<span class='field'>eof</span>() {
    <span class='keyword'>var</span> args = io.<span class='field'>input</span>(<span class='string'>"</span><span class='escape'>\</span><span class='escape'>(</span>pwd()<span class='escape'>)</span><span class='string'> $ "</span>).<span class='field'>split</span>(delim);
    <span class='keyword'>if</span> <span class='keyword'>len</span>(args) == <span class='constant'>0</span> {
        <span class='keyword'>continue</span>;
    }

    <span class='keyword'>var</span> cmd = args[<span class='constant'>0</span>];

    <span class='comment'># Builtin 'exit'</span>
    <span class='comment'># Usage:</span>
    <span class='comment'>#   exit         -&gt; Exits with 0</span>
    <span class='comment'>#   exit &lt;CODE&gt;  -&gt; Exits with CODE</span>
    <span class='keyword'>if</span> cmd == <span class='string'>"exit"</span> {
        <span class='keyword'>if</span> <span class='keyword'>len</span>(args) &gt; <span class='constant'>2</span> {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: too many arguments to command '</span><span class='escape'>\</span><span class='escape'>(</span>cmd<span class='escape'>)</span><span class='string'>'"</span>);
            <span class='keyword'>continue</span>;
        }

        <span class='keyword'>var</span> code = <span class='keyword'>if</span> <span class='keyword'>len</span>(args) == <span class='constant'>2</span> <span class='keyword'>then</span> args[<span class='constant'>1</span>].<span class='field'>tonumber</span>() <span class='keyword'>else</span> <span class='constant'>0</span>;
        <span class='keyword'>if</span> !code {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid exit code '</span><span class='escape'>\</span><span class='escape'>(</span>args[<span class='constant'>1</span>]<span class='escape'>)</span><span class='string'>'"</span>);
            <span class='keyword'>continue</span>;
        }

        os.<span class='field'>exit</span>(code);
    }

    <span class='comment'># Builtin 'cd'</span>
    <span class='comment'># Usage:</span>
    <span class='comment'>#   cd        -&gt; Go to HOME</span>
    <span class='comment'>#   cd &lt;DIR&gt;  -&gt; Go to DIR</span>
    <span class='comment'>#   cd -      -&gt; Go to previous location</span>
    <span class='keyword'>if</span> cmd == <span class='string'>"cd"</span> {
        <span class='keyword'>if</span> <span class='keyword'>len</span>(args) &gt; <span class='constant'>2</span> {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: too many arguments to command '</span><span class='escape'>\</span><span class='escape'>(</span>cmd<span class='escape'>)</span><span class='string'>'"</span>);
            <span class='keyword'>continue</span>;
        }

        <span class='keyword'>var</span> path = <span class='keyword'>if</span> <span class='keyword'>len</span>(args) == <span class='constant'>2</span> <span class='keyword'>then</span> args[<span class='constant'>1</span>] <span class='keyword'>else</span> <span class='string'>"~"</span>;
        <span class='keyword'>if</span> path == <span class='string'>"-"</span> {
            <span class='keyword'>if</span> !previous {
                io.<span class='field'>eprintln</span>(<span class='string'>"Error: no previous directory to go into"</span>);
                <span class='keyword'>continue</span>;
            }

            path = previous;
        }

        <span class='keyword'>if</span> path.<span class='field'>prefix</span>(<span class='string'>"~"</span>) {
            path = home ++ path.<span class='field'>slice</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> current = os.<span class='field'>getcwd</span>();
        <span class='keyword'>if</span> !os.<span class='field'>setcwd</span>(path) {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: the directory '</span><span class='escape'>\</span><span class='escape'>(</span>path<span class='escape'>)</span><span class='string'>' does not exist"</span>);
        }

        previous = current;
        <span class='keyword'>continue</span>;
    }

    <span class='keyword'>var</span> p = os.<span class='field'>Process</span>(args);
    <span class='keyword'>if</span> !p {
        io.<span class='field'>eprintln</span>(<span class='string'>"Error: unknown command '</span><span class='escape'>\</span><span class='escape'>(</span>cmd<span class='escape'>)</span><span class='string'>'"</span>);
        <span class='keyword'>continue</span>;
    }
    p.<span class='field'>wait</span>();
}

<span class='comment'># In case of CTRL-d</span>
io.<span class='field'>println</span>();
</pre>
</pre>
</div>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>bs shell.bs
~/Git/bs/examples/shell $ ls -a
.  ..  README.md  shell.bs
</pre>
</div>
<p>
Use
<a href="https://github.com/hanslub42/rlwrap"><code>rlwrap</code></a>
in order to get readline bindings and filename autocompletion.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>rlwrap -c bs shell.bs <span class='comment'># Like so</span>
</pre>
</div>
</section>
<section id='s3'>
<h2> Rule110</h2>
<p>
An implementation of
<a href="https://en.wikipedia.org/wiki/Rule_110">Rule110</a>
for proof of Turing Completeness.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># rule110.bs</span>

<span class='keyword'>var</span> board = [].<span class='field'>resize</span>(<span class='constant'>30</span>).<span class='field'>fill</span>(<span class='constant'>0</span>);
board[<span class='keyword'>len</span>(board) - <span class='constant'>2</span>] = <span class='constant'>1</span>;

<span class='keyword'>for</span> i <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='keyword'>len</span>(board) - <span class='constant'>2</span> {
    <span class='keyword'>for</span> _, j <span class='keyword'>in</span> board {
        io.<span class='field'>print</span>(<span class='keyword'>if</span> j != <span class='constant'>0</span> <span class='keyword'>then</span> <span class='string'>"*"</span> <span class='keyword'>else</span> <span class='string'>" "</span>);
    }
    io.<span class='field'>println</span>();

    <span class='keyword'>var</span> pattern = (board[<span class='constant'>0</span>] &lt;&lt; <span class='constant'>1</span>) | board[<span class='constant'>1</span>];
    <span class='keyword'>for</span> j <span class='keyword'>in</span> <span class='constant'>1</span>, <span class='keyword'>len</span>(board) - <span class='constant'>1</span> {
        pattern = ((pattern &lt;&lt; <span class='constant'>1</span>) &amp; <span class='constant'>7</span>) | board[j + <span class='constant'>1</span>];
        board[j] = (<span class='constant'>110</span> &gt;&gt; pattern) &amp; <span class='constant'>1</span>;
    }
}
</pre>
</pre>
</div>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>bs rule110.bs
                            *
                           **
                          ***
                         ** *
                        *****
                       **   *
                      ***  **
                     ** * ***
                    ******* *
                   **     ***
                  ***    ** *
                 ** *   *****
                *****  **   *
               **   * ***  **
              ***  **** * ***
             ** * **  ***** *
            ******** **   ***
           **      ****  ** *
          ***     **  * *****
         ** *    *** ****   *
        *****   ** ***  *  **
       **   *  ***** * ** ***
      ***  ** **   ******** *
     ** * ******  **      ***
    *******    * ***     ** *
   **     *   **** *    *****
  ***    **  **  ***   **   *
 ** *   *** *** ** *  ***  **
</pre>
</div>
</section>
<section id='s4'>
<h2> Game Of Life</h2>
<p>
An implementation of
<a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Conway's Game Of Life</a>
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># GameOfLife.bs</span>

<span class='keyword'>class</span> <span class='class'>GameOfLife</span> {
    init(width, height) {
        <span class='constant'>this</span>.<span class='field'>width</span> = width;
        <span class='constant'>this</span>.<span class='field'>height</span> = height;

        <span class='constant'>this</span>.<span class='field'>board</span> = [];
        <span class='constant'>this</span>.<span class='field'>buffer</span> = [];

        <span class='constant'>this</span>.<span class='field'>board</span>.<span class='field'>resize</span>(width * height);
        <span class='constant'>this</span>.<span class='field'>buffer</span>.<span class='field'>resize</span>(width * height);
    }

    get(x, y) {
        x %= <span class='constant'>this</span>.<span class='field'>width</span>;
        y %= <span class='constant'>this</span>.<span class='field'>height</span>;
        <span class='keyword'>return</span> <span class='constant'>this</span>.<span class='field'>board</span>[y * <span class='constant'>this</span>.<span class='field'>width</span> + x];
    }

    set(x, y, v) {
        x %= <span class='constant'>this</span>.<span class='field'>width</span>;
        y %= <span class='constant'>this</span>.<span class='field'>height</span>;
        <span class='constant'>this</span>.<span class='field'>board</span>[y * <span class='constant'>this</span>.<span class='field'>width</span> + x] = v;
    }

    step() {
        <span class='keyword'>fn</span> <span class='function'>set</span>(x, y, v) {
            x %= <span class='constant'>this</span>.<span class='field'>width</span>;
            y %= <span class='constant'>this</span>.<span class='field'>height</span>;
            <span class='constant'>this</span>.<span class='field'>buffer</span>[y * <span class='constant'>this</span>.<span class='field'>width</span> + x] = v;
        }

        <span class='keyword'>fn</span> <span class='function'>nbors</span>(x, y) {
            <span class='keyword'>var</span> count = <span class='constant'>0</span>;
            <span class='keyword'>for</span> dy <span class='keyword'>in</span> -<span class='constant'>1</span>, <span class='constant'>2</span> {
                <span class='keyword'>for</span> dx <span class='keyword'>in</span> -<span class='constant'>1</span>, <span class='constant'>2</span> {
                    <span class='keyword'>if</span> dx == <span class='constant'>0</span> &amp;&amp; dy == <span class='constant'>0</span> {
                        <span class='keyword'>continue</span>;
                    }

                    <span class='keyword'>if</span> <span class='constant'>this</span>.<span class='field'>get</span>(x + dx, y + dy) {
                        count += <span class='constant'>1</span>;
                    }
                }
            }
            <span class='keyword'>return</span> count;
        }

        <span class='keyword'>for</span> y <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>height</span> {
            <span class='keyword'>for</span> x <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>width</span> {
                <span class='keyword'>var</span> n = nbors(x, y);
                <span class='keyword'>if</span> n == <span class='constant'>2</span> {
                    set(x, y, <span class='constant'>this</span>.<span class='field'>get</span>(x, y));
                } <span class='keyword'>else</span> {
                    set(x, y, n == <span class='constant'>3</span>);
                }
            }
        }

        <span class='comment'># Swap buffers</span>
        <span class='keyword'>var</span> t = <span class='constant'>this</span>.<span class='field'>board</span>;
        <span class='constant'>this</span>.<span class='field'>board</span> = <span class='constant'>this</span>.<span class='field'>buffer</span>;
        <span class='constant'>this</span>.<span class='field'>buffer</span> = t;
    }

    <span class='comment'># (X, Y) is the center of the glider</span>
    glider(x, y) {
        <span class='constant'>this</span>.<span class='field'>set</span>(x + <span class='constant'>0</span>, y - <span class='constant'>1</span>, <span class='constant'>true</span>);
        <span class='constant'>this</span>.<span class='field'>set</span>(x + <span class='constant'>1</span>, y + <span class='constant'>0</span>, <span class='constant'>true</span>);
        <span class='constant'>this</span>.<span class='field'>set</span>(x - <span class='constant'>1</span>, y + <span class='constant'>1</span>, <span class='constant'>true</span>);
        <span class='constant'>this</span>.<span class='field'>set</span>(x + <span class='constant'>0</span>, y + <span class='constant'>1</span>, <span class='constant'>true</span>);
        <span class='constant'>this</span>.<span class='field'>set</span>(x + <span class='constant'>1</span>, y + <span class='constant'>1</span>, <span class='constant'>true</span>);
    }
}

<span class='keyword'>return</span> GameOfLife;
</pre>
</pre>
</div>
<section id='s5'>
<h3> Console</h3>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># game_of_life_tui.bs</span>

<span class='keyword'>var</span> GameOfLife = <span class='keyword'>import</span>(<span class='string'>"GameOfLife"</span>);

<span class='keyword'>var</span> INTERVAL = <span class='constant'>0.1</span>;

<span class='keyword'>class</span> <span class='class'>GameOfLifeTUI</span> &lt; <span class='class'>GameOfLife</span> {
    init(width, height) {
        <span class='constant'>super</span>.<span class='field'>init</span>(width, height);
    }

    show() {
        <span class='keyword'>for</span> y <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>height</span> {
            <span class='keyword'>for</span> x <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>width</span> {
                io.<span class='field'>print</span>(<span class='keyword'>if</span> <span class='constant'>this</span>.<span class='field'>get</span>(x, y) <span class='keyword'>then</span> <span class='string'>"#"</span> <span class='keyword'>else</span> <span class='string'>"."</span>);
            }
            io.<span class='field'>println</span>();
        }
    }
}

<span class='keyword'>var</span> gol = GameOfLifeTUI(<span class='constant'>20</span>, <span class='constant'>10</span>);
gol.<span class='field'>glider</span>(<span class='constant'>1</span>, <span class='constant'>1</span>);

<span class='keyword'>while</span> <span class='constant'>true</span> {
    gol.<span class='field'>show</span>();
    gol.<span class='field'>step</span>();
    io.<span class='field'>print</span>(<span class='string'>"</span><span class='escape'>\e</span><span class='string'>[</span><span class='escape'>\</span><span class='escape'>(</span>gol.<span class='field'>height</span><span class='escape'>)</span><span class='string'>A</span><span class='escape'>\e</span><span class='string'>[</span><span class='escape'>\</span><span class='escape'>(</span>gol.<span class='field'>width</span><span class='escape'>)</span><span class='string'>D"</span>);
    os.<span class='field'>sleep</span>(INTERVAL);
}
</pre>
</pre>
</div>
<p>
Run the program.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>bs game_of_life_tui.bs
</pre>
</div>
</section>
<section id='s6'>
<h3> Raylib</h3>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'>// raylib.c
</span>
<span class='field'>#include</span> <span class='string'>&lt;math.h&gt;</span>

<span class='field'>#include</span> <span class='string'>"bs/object.h"</span>
<span class='field'>#include</span> <span class='string'>"raylib.h"</span>

<span class='class'>Bs_Value</span> rl_init_window(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>3</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>0</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>1</span>);
    <span class='function'>bs_arg_check_object_type</span>(bs, args, <span class='constant'>2</span>, <span class='constant'>BS_OBJECT_STR</span>);

    <span class='keyword'>const</span> <span class='class'>int</span> width = args[<span class='constant'>0</span>].as.number;
    <span class='keyword'>const</span> <span class='class'>int</span> height = args[<span class='constant'>1</span>].as.number;
    <span class='keyword'>const</span> <span class='class'>Bs_Str</span> *title = (<span class='keyword'>const</span> <span class='class'>Bs_Str</span> *)args[<span class='constant'>2</span>].as.object;

    <span class='comment'>// BS strings are null terminated by default for FFI convenience
</span>    <span class='function'>InitWindow</span>(width, height, title-&gt;data);
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_close_window(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='function'>CloseWindow</span>();
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_window_should_close(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_bool</span>(<span class='function'>WindowShouldClose</span>());
}

<span class='class'>Bs_Value</span> rl_begin_drawing(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='function'>BeginDrawing</span>();
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_end_drawing(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='function'>EndDrawing</span>();
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_clear_background(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>1</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>0</span>);
    <span class='function'>ClearBackground</span>(<span class='function'>GetColor</span>(args[<span class='constant'>0</span>].as.number));
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_set_exit_key(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>1</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>0</span>);
    SetExitKey(args[<span class='constant'>0</span>].as.number);
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_set_config_flags(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>1</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>0</span>);
    SetConfigFlags(args[<span class='constant'>0</span>].as.number);
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_draw_line(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>5</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>0</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>1</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>2</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>3</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>4</span>, <span class='constant'>BS_VALUE_NUM</span>);

    <span class='keyword'>const</span> <span class='class'>int</span> startPosX = round(args[<span class='constant'>0</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> startPosY = round(args[<span class='constant'>1</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> endPosX = round(args[<span class='constant'>2</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> endPosY = round(args[<span class='constant'>3</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>Color</span> color = <span class='function'>GetColor</span>(args[<span class='constant'>4</span>].as.number);

    DrawLine(startPosX, startPosY, endPosX, endPosY, color);
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_draw_text(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>5</span>);
    <span class='function'>bs_arg_check_object_type</span>(bs, args, <span class='constant'>0</span>, <span class='constant'>BS_OBJECT_STR</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>1</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>2</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>3</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>4</span>);

    <span class='keyword'>const</span> <span class='class'>Bs_Str</span> *text = (<span class='keyword'>const</span> <span class='class'>Bs_Str</span> *)args[<span class='constant'>0</span>].as.object;
    <span class='keyword'>const</span> <span class='class'>int</span> x = round(args[<span class='constant'>1</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> y = round(args[<span class='constant'>2</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> size = args[<span class='constant'>3</span>].as.number;
    <span class='keyword'>const</span> <span class='class'>Color</span> color = <span class='function'>GetColor</span>(args[<span class='constant'>4</span>].as.number);

    <span class='function'>DrawText</span>(text-&gt;data, x, y, size, color);
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_draw_rectangle(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>5</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>0</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>1</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>2</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_value_type</span>(bs, args, <span class='constant'>3</span>, <span class='constant'>BS_VALUE_NUM</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>4</span>);

    <span class='keyword'>const</span> <span class='class'>int</span> posX = round(args[<span class='constant'>0</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> posY = round(args[<span class='constant'>1</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> width = round(args[<span class='constant'>2</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>int</span> height = round(args[<span class='constant'>3</span>].as.number);
    <span class='keyword'>const</span> <span class='class'>Color</span> color = <span class='function'>GetColor</span>(args[<span class='constant'>4</span>].as.number);

    DrawRectangle(posX, posY, width, height, color);
    <span class='keyword'>return</span> <span class='constant'>bs_value_nil</span>;
}

<span class='class'>Bs_Value</span> rl_get_screen_width(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_num</span>(GetScreenWidth());
}

<span class='class'>Bs_Value</span> rl_get_screen_height(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_num</span>(GetScreenHeight());
}

<span class='class'>Bs_Value</span> rl_get_frame_time(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_num</span>(GetFrameTime());
}

<span class='class'>Bs_Value</span> rl_get_mouse_x(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_num</span>(GetMouseX());
}

<span class='class'>Bs_Value</span> rl_get_mouse_y(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_num</span>(GetMouseY());
}

<span class='class'>Bs_Value</span> rl_is_mouse_button_released(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>1</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_bool</span>(IsMouseButtonReleased(args[<span class='constant'>0</span>].as.number));
}

<span class='class'>Bs_Value</span> rl_is_key_pressed(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>1</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>0</span>);
    <span class='keyword'>return</span> <span class='function'>bs_value_bool</span>(IsKeyPressed(args[<span class='constant'>0</span>].as.number));
}

<span class='class'>Bs_Value</span> rl_measure_text(<span class='class'>Bs</span> *bs, <span class='class'>Bs_Value</span> *args, <span class='class'>size_t</span> arity) {
    <span class='function'>bs_check_arity</span>(bs, arity, <span class='constant'>2</span>);
    <span class='function'>bs_arg_check_object_type</span>(bs, args, <span class='constant'>0</span>, <span class='constant'>BS_OBJECT_STR</span>);
    <span class='function'>bs_arg_check_whole_number</span>(bs, args, <span class='constant'>1</span>);

    <span class='keyword'>const</span> <span class='class'>Bs_Str</span> *text = (<span class='keyword'>const</span> <span class='class'>Bs_Str</span> *)args[<span class='constant'>0</span>].as.object;
    <span class='keyword'>const</span> <span class='class'>int</span> size = args[<span class='constant'>1</span>].as.number;

    <span class='keyword'>return</span> <span class='function'>bs_value_num</span>(MeasureText(text-&gt;data, size));
}

<span class='constant'>BS_LIBRARY_INIT</span> <span class='class'>void</span> bs_library_init(<span class='class'>Bs</span> *bs, <span class='class'>Bs_C_Lib</span> *library) {
    <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='class'>Bs_FFI</span> ffi[] = {
        {<span class='string'>"init_window"</span>, rl_init_window},
        {<span class='string'>"close_window"</span>, rl_close_window},
        {<span class='string'>"window_should_close"</span>, rl_window_should_close},
        {<span class='string'>"begin_drawing"</span>, rl_begin_drawing},
        {<span class='string'>"end_drawing"</span>, rl_end_drawing},
        {<span class='string'>"clear_background"</span>, rl_clear_background},
        {<span class='string'>"set_exit_key"</span>, rl_set_exit_key},
        {<span class='string'>"set_config_flags"</span>, rl_set_config_flags},
        {<span class='string'>"draw_line"</span>, rl_draw_line},
        {<span class='string'>"draw_text"</span>, rl_draw_text},
        {<span class='string'>"draw_rectangle"</span>, rl_draw_rectangle},
        {<span class='string'>"get_screen_width"</span>, rl_get_screen_width},
        {<span class='string'>"get_screen_height"</span>, rl_get_screen_height},
        {<span class='string'>"get_frame_time"</span>, rl_get_frame_time},
        {<span class='string'>"get_mouse_x"</span>, rl_get_mouse_x},
        {<span class='string'>"get_mouse_y"</span>, rl_get_mouse_y},
        {<span class='string'>"is_mouse_button_released"</span>, rl_is_mouse_button_released},
        {<span class='string'>"is_key_pressed"</span>, rl_is_key_pressed},
        {<span class='string'>"measure_text"</span>, rl_measure_text},
    };
    <span class='function'>bs_c_lib_ffi</span>(bs, library, ffi, <span class='function'>bs_c_array_size</span>(ffi));

    bs_c_lib_set(bs, library, Bs_Sv_Static(<span class='string'>"MOUSE_BUTTON_LEFT"</span>), <span class='function'>bs_value_num</span>(MOUSE_BUTTON_LEFT));

    bs_c_lib_set(
        bs, library, Bs_Sv_Static(<span class='string'>"FLAG_WINDOW_RESIZABLE"</span>), <span class='function'>bs_value_num</span>(FLAG_WINDOW_RESIZABLE));
}
</pre>
</div>
<p>
Compile the raylib module.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>cc -o raylib.so -fPIC -shared raylib.c -lbs -lraylib    <span class='comment'># On Linux</span>
<span class='constant'>$ </span>cc -o raylib.dylib -fPIC -shared raylib.c -lbs -lraylib <span class='comment'># On macOS</span>
<span class='constant'>$ </span>cl /LD /Fe:raylib.dll raylib.c bs.lib raylib.lib        <span class='comment'># On Windows</span>
</pre>
</div>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># game_of_life_raylib.bs</span>

<span class='keyword'>var</span> rl = <span class='keyword'>import</span>(<span class='string'>"raylib"</span>);
<span class='keyword'>var</span> GameOfLife = <span class='keyword'>import</span>(<span class='string'>"GameOfLife"</span>);

<span class='keyword'>var</span> GRID = <span class='constant'>0x5A524CFF</span>;
<span class='keyword'>var</span> BACKGROUND = <span class='constant'>0x282828FF</span>;
<span class='keyword'>var</span> FOREGROUND = <span class='constant'>0x89B482FF</span>;

<span class='keyword'>var</span> INTERVAL = <span class='constant'>0.1</span>;
<span class='keyword'>var</span> FONT_SIZE = <span class='constant'>30</span>;

<span class='keyword'>var</span> width = <span class='constant'>800</span>;
<span class='keyword'>var</span> height = <span class='constant'>600</span>;

<span class='keyword'>var</span> cell_size = <span class='constant'>0</span>;
<span class='keyword'>var</span> padding_x = <span class='constant'>0</span>;
<span class='keyword'>var</span> padding_y = <span class='constant'>0</span>;

<span class='keyword'>class</span> <span class='class'>GameOfLifeRaylib</span> &lt; <span class='class'>GameOfLife</span> {
    init(width, height) {
        <span class='constant'>super</span>.<span class='field'>init</span>(width, height);
        <span class='constant'>this</span>.<span class='field'>clock</span> = <span class='constant'>0</span>;
        <span class='constant'>this</span>.<span class='field'>paused</span> = <span class='constant'>false</span>;
    }

    show() {
        width = rl.<span class='field'>get_screen_width</span>();
        height = rl.<span class='field'>get_screen_height</span>() - FONT_SIZE * <span class='constant'>1.2</span>;

        <span class='keyword'>var</span> cw = width / <span class='constant'>this</span>.<span class='field'>width</span>;
        <span class='keyword'>var</span> ch = height / <span class='constant'>this</span>.<span class='field'>height</span>;
        cell_size = cw.<span class='field'>min</span>(ch);

        padding_x = (width - <span class='constant'>this</span>.<span class='field'>width</span> * cell_size) / <span class='constant'>2</span>;
        padding_y = (height - <span class='constant'>this</span>.<span class='field'>height</span> * cell_size) / <span class='constant'>2</span>;

        rl.<span class='field'>draw_rectangle</span>(
            padding_x,
            padding_y,
            <span class='constant'>this</span>.<span class='field'>width</span> * cell_size,
            <span class='constant'>this</span>.<span class='field'>height</span> * cell_size,
            BACKGROUND);

        {
            <span class='keyword'>var</span> label = <span class='string'>"Click to toggle cell, Space to play/pause"</span>;
            rl.<span class='field'>draw_text</span>(
                label,
                (width - rl.<span class='field'>measure_text</span>(label, FONT_SIZE)) / <span class='constant'>2</span>,
                <span class='constant'>this</span>.<span class='field'>height</span> * cell_size + FONT_SIZE * <span class='constant'>0.1</span>,
                FONT_SIZE,
                FOREGROUND);
        }

        <span class='keyword'>for</span> i <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>width</span> + <span class='constant'>1</span> {
            <span class='keyword'>var</span> x = padding_x + i * cell_size;
            rl.<span class='field'>draw_line</span>(x, <span class='constant'>0</span>, x, <span class='constant'>this</span>.<span class='field'>height</span> * cell_size, GRID);
        }

        <span class='keyword'>for</span> i <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>height</span> + <span class='constant'>1</span> {
            <span class='keyword'>var</span> y = padding_y + i * cell_size;
            rl.<span class='field'>draw_line</span>(padding_x, y, padding_x + <span class='constant'>this</span>.<span class='field'>width</span> * cell_size, y, GRID);
        }

        <span class='keyword'>for</span> y <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>height</span> {
            <span class='keyword'>for</span> x <span class='keyword'>in</span> <span class='constant'>0</span>, <span class='constant'>this</span>.<span class='field'>width</span> {
                <span class='keyword'>if</span> <span class='constant'>this</span>.<span class='field'>get</span>(x, y) {
                    rl.<span class='field'>draw_rectangle</span>(
                        padding_x + x * cell_size,
                        padding_y + y * cell_size,
                        cell_size,
                        cell_size,
                        FOREGROUND);
                }
            }
        }
    }
}

rl.<span class='field'>init_window</span>(width, height, <span class='string'>"Game Of Life"</span>);
rl.<span class='field'>set_exit_key</span>(ascii.<span class='field'>code</span>(<span class='string'>"Q"</span>));
rl.<span class='field'>set_config_flags</span>(rl.<span class='field'>FLAG_WINDOW_RESIZABLE</span>);

<span class='keyword'>var</span> gol = GameOfLifeRaylib(<span class='constant'>20</span>, <span class='constant'>20</span>);
gol.<span class='field'>glider</span>(<span class='constant'>2</span>, <span class='constant'>2</span>);

<span class='keyword'>while</span> !rl.<span class='field'>window_should_close</span>() {
    rl.<span class='field'>begin_drawing</span>();
    rl.<span class='field'>clear_background</span>(<span class='constant'>0x181818FF</span>);

    gol.<span class='field'>show</span>();

    <span class='keyword'>if</span> !gol.<span class='field'>paused</span> {
        gol.<span class='field'>clock</span> += rl.<span class='field'>get_frame_time</span>();
        <span class='keyword'>if</span> gol.<span class='field'>clock</span> &gt;= INTERVAL {
            gol.<span class='field'>clock</span> = <span class='constant'>0</span>;
            gol.<span class='field'>step</span>();
        }
    }

    <span class='keyword'>if</span> rl.<span class='field'>is_key_pressed</span>(ascii.<span class='field'>code</span>(<span class='string'>" "</span>)) {
        gol.<span class='field'>paused</span> = !gol.<span class='field'>paused</span>;
    }

    <span class='keyword'>if</span> rl.<span class='field'>is_mouse_button_released</span>(rl.<span class='field'>MOUSE_BUTTON_LEFT</span>) {
        <span class='keyword'>var</span> x = ((rl.<span class='field'>get_mouse_x</span>() - padding_x) / cell_size).<span class='field'>floor</span>();
        <span class='keyword'>var</span> y = ((rl.<span class='field'>get_mouse_y</span>() - padding_y) / cell_size).<span class='field'>floor</span>();
        gol.<span class='field'>set</span>(x, y, !gol.<span class='field'>get</span>(x, y));
    }

    rl.<span class='field'>end_drawing</span>();
}

rl.<span class='field'>close_window</span>();
</pre>
</pre>
</div>
<p>
Run the program.
</p>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='constant'>$ </span>bs game_of_life_raylib.bs
</pre>
</div>
</section>
</section>
<section id='s7'>
<h2> CLI Task Management APP</h2>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># tasks.bs</span>

<span class='keyword'>var</span> TASKS_PATH = os.<span class='field'>getenv</span>(<span class='string'>"HOME"</span>) ++ <span class='string'>"/.tasks"</span>;

<span class='keyword'>fn</span> <span class='function'>date</span>(d) {
    <span class='keyword'>if</span> !d {
        <span class='keyword'>return</span> <span class='string'>""</span>;
    }

    <span class='keyword'>var</span> year = <span class='string'>"</span><span class='escape'>\</span><span class='escape'>(</span>d[<span class='constant'>0</span>]<span class='escape'>)</span><span class='string'>"</span>.<span class='field'>lpad</span>(<span class='string'>"0"</span>, <span class='constant'>4</span>);
    <span class='keyword'>var</span> month = <span class='string'>"</span><span class='escape'>\</span><span class='escape'>(</span>d[<span class='constant'>1</span>]<span class='escape'>)</span><span class='string'>"</span>.<span class='field'>lpad</span>(<span class='string'>"0"</span>, <span class='constant'>2</span>);
    <span class='keyword'>var</span> day = <span class='string'>"</span><span class='escape'>\</span><span class='escape'>(</span>d[<span class='constant'>2</span>]<span class='escape'>)</span><span class='string'>"</span>.<span class='field'>lpad</span>(<span class='string'>"0"</span>, <span class='constant'>2</span>);
    <span class='keyword'>return</span> <span class='string'>"</span><span class='escape'>\</span><span class='escape'>(</span>year<span class='escape'>)</span><span class='string'>-</span><span class='escape'>\</span><span class='escape'>(</span>month<span class='escape'>)</span><span class='string'>-</span><span class='escape'>\</span><span class='escape'>(</span>day<span class='escape'>)</span><span class='string'>"</span>;
}

<span class='keyword'>fn</span> <span class='function'>flags</span>(start, template) {
    <span class='keyword'>var</span> parsed = {};

    <span class='keyword'>var</span> i = start;
    <span class='keyword'>while</span> i &lt; <span class='keyword'>len</span>(os.<span class='field'>args</span>) {
        <span class='keyword'>var</span> arg = os.<span class='field'>args</span>[i]; i += <span class='constant'>1</span>;
        <span class='keyword'>if</span> !arg.<span class='field'>prefix</span>(<span class='string'>"-"</span>) || !(arg.<span class='field'>slice</span>(<span class='constant'>1</span>) <span class='keyword'>in</span> template) {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: unexpected argument '</span><span class='escape'>\</span><span class='escape'>(</span>arg<span class='escape'>)</span><span class='string'>'"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"Expected:"</span>);

            <span class='keyword'>var</span> length = <span class='constant'>0</span>;
            <span class='keyword'>for</span> flag, _ <span class='keyword'>in</span> template {
                length = length.<span class='field'>max</span>(<span class='keyword'>len</span>(flag));
            }

            <span class='keyword'>for</span> flag, desc <span class='keyword'>in</span> template {
                io.<span class='field'>eprintln</span>(<span class='string'>"    -</span><span class='escape'>\</span><span class='escape'>(</span>flag.<span class='field'>rpad</span>(<span class='string'>" "</span>, length)<span class='escape'>)</span><span class='string'>    </span><span class='escape'>\</span><span class='escape'>(</span>desc<span class='escape'>)</span><span class='string'>"</span>);
            }

            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }
        <span class='keyword'>var</span> flag = arg.<span class='field'>slice</span>(<span class='constant'>1</span>);

        <span class='keyword'>if</span> i &gt;= <span class='keyword'>len</span>(os.<span class='field'>args</span>) {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: value not provided for flag '</span><span class='escape'>\</span><span class='escape'>(</span>arg<span class='escape'>)</span><span class='string'>'"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"Usage:"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"    </span><span class='escape'>\</span><span class='escape'>(</span>arg<span class='escape'>)</span><span class='string'> &lt;value&gt;    </span><span class='escape'>\</span><span class='escape'>(</span>template[flag]<span class='escape'>)</span><span class='string'>"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }
        <span class='keyword'>var</span> value = os.<span class='field'>args</span>[i]; i += <span class='constant'>1</span>;

        parsed[flag] = value;
    }

    <span class='keyword'>return</span> parsed;
}

<span class='keyword'>fn</span> <span class='function'>currently</span>(n, label) {
    <span class='keyword'>if</span> n == <span class='constant'>1</span> {
        io.<span class='field'>eprintln</span>(<span class='string'>"Note: there is currently </span><span class='escape'>\</span><span class='escape'>(</span>n<span class='escape'>)</span><span class='string'> </span><span class='escape'>\</span><span class='escape'>(</span>label<span class='escape'>)</span><span class='string'>"</span>);
    } <span class='keyword'>else</span> {
        io.<span class='field'>eprintln</span>(<span class='string'>"Note: there are currently </span><span class='escape'>\</span><span class='escape'>(</span>n<span class='escape'>)</span><span class='string'> </span><span class='escape'>\</span><span class='escape'>(</span>label<span class='escape'>)</span><span class='string'>s"</span>);
    }
}

<span class='keyword'>var</span> FLAGS = {
    due = <span class='string'>"The due date for the completion of the task. Expected format is 'YYYY-MM-DD'"</span>,
    tag = <span class='string'>"The tags associated with the task. Expects a comma separated list of names"</span>,
    priority = <span class='string'>"The priority of the task. Can be 'low', 'medium', or 'high' (Default: 'medium')"</span>,
};

<span class='keyword'>var</span> PRIORITIES = [<span class='string'>"low"</span>, <span class='string'>"medium"</span>, <span class='string'>"high"</span>];

<span class='keyword'>class</span> <span class='class'>Task</span> {
    init(title) {
        <span class='constant'>this</span>.<span class='field'>title</span> = title;
        <span class='constant'>this</span>.<span class='field'>due</span> = <span class='constant'>nil</span>;
        <span class='constant'>this</span>.<span class='field'>tags</span> = [];
        <span class='constant'>this</span>.<span class='field'>priority</span> = <span class='constant'>1</span>;
    }

    set_due(date) {
        <span class='keyword'>if</span> <span class='keyword'>len</span>(date) == <span class='constant'>0</span> {
            <span class='constant'>this</span>.<span class='field'>due</span> = <span class='constant'>nil</span>;
            <span class='keyword'>return</span>;
        }

        <span class='keyword'>var</span> format = <span class='string'>"YYYY-MM-DD"</span>;
        <span class='keyword'>if</span> <span class='keyword'>len</span>(date) != <span class='keyword'>len</span>(format) {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid due date '</span><span class='escape'>\</span><span class='escape'>(</span>date<span class='escape'>)</span><span class='string'>'. Expected format '</span><span class='escape'>\</span><span class='escape'>(</span>format<span class='escape'>)</span><span class='string'>'"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> year = date.<span class='field'>slice</span>(<span class='constant'>0</span>, <span class='constant'>4</span>).<span class='field'>tonumber</span>();
        <span class='keyword'>var</span> month = date.<span class='field'>slice</span>(<span class='constant'>5</span>, <span class='constant'>7</span>).<span class='field'>tonumber</span>();
        <span class='keyword'>var</span> day = date.<span class='field'>slice</span>(<span class='constant'>8</span>, <span class='constant'>10</span>).<span class='field'>tonumber</span>();

        <span class='keyword'>if</span> !year || !month || !day {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid due date '</span><span class='escape'>\</span><span class='escape'>(</span>date<span class='escape'>)</span><span class='string'>'. Expected format '</span><span class='escape'>\</span><span class='escape'>(</span>format<span class='escape'>)</span><span class='string'>'"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='constant'>this</span>.<span class='field'>due</span> = [year, month, day];
    }

    set_tag(labels) {
        <span class='keyword'>for</span> _, tag <span class='keyword'>in</span> labels.<span class='field'>split</span>(<span class='string'>","</span>) {
            <span class='constant'>this</span>.<span class='field'>tags</span>.<span class='field'>push</span>(tag.<span class='field'>trim</span>(<span class='string'>" "</span>));
        }
    }

    set_priority(value) {
        <span class='constant'>this</span>.<span class='field'>priority</span> = PRIORITIES.<span class='field'>find</span>(value);
        <span class='keyword'>if</span> !<span class='constant'>this</span>.<span class='field'>priority</span> {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid priority '</span><span class='escape'>\</span><span class='escape'>(</span>value<span class='escape'>)</span><span class='string'>'"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"Expected:"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"    low"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"    medium    (Default)"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"    high"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }
    }

    show() {
        <span class='keyword'>var</span> final = <span class='constant'>this</span>.<span class='field'>title</span>;

        <span class='keyword'>if</span> <span class='constant'>this</span>.<span class='field'>due</span> {
            final ++= <span class='string'>" (Due: </span><span class='escape'>\</span><span class='escape'>(</span>date(<span class='constant'>this</span>.<span class='field'>due</span>)<span class='escape'>)</span><span class='string'>)"</span>;
        }

        final ++= <span class='string'>" [Priority: </span><span class='escape'>\</span><span class='escape'>(</span>PRIORITIES[<span class='constant'>this</span>.<span class='field'>priority</span>]<span class='escape'>)</span><span class='string'>]"</span>;

        <span class='keyword'>if</span> <span class='keyword'>len</span>(<span class='constant'>this</span>.<span class='field'>tags</span>) &gt; <span class='constant'>0</span> {
            final ++= <span class='string'>" [Tags: </span><span class='escape'>\</span><span class='escape'>(</span><span class='constant'>this</span>.<span class='field'>tags</span>.<span class='field'>join</span>(<span class='string'>", "</span>)<span class='escape'>)</span><span class='string'>]"</span>;
        }

        <span class='keyword'>return</span> final;
    }
}

<span class='keyword'>class</span> <span class='class'>Tasks</span> {
    init(path) {
        <span class='constant'>this</span>.<span class='field'>path</span> = path;
        <span class='constant'>this</span>.<span class='field'>pending</span> = [];
        <span class='constant'>this</span>.<span class='field'>completed</span> = [];

        <span class='keyword'>var</span> f = io.<span class='field'>Reader</span>(path);
        <span class='keyword'>if</span> !f {
            <span class='keyword'>return</span>;
        }

        <span class='keyword'>var</span> lines = f.<span class='field'>read</span>().<span class='field'>split</span>(<span class='string'>"</span><span class='escape'>\n</span><span class='string'>"</span>);
        <span class='keyword'>var</span> i = <span class='constant'>0</span>;
        <span class='keyword'>while</span> i &lt; <span class='keyword'>len</span>(lines) {
            <span class='keyword'>var</span> line = lines[i]; i += <span class='constant'>1</span>;

            <span class='keyword'>var</span> task;
            <span class='keyword'>if</span> line.<span class='field'>prefix</span>(<span class='string'>"PENDING:"</span>) {
                task = Task(line.<span class='field'>slice</span>(<span class='keyword'>len</span>(<span class='string'>"PENDING:"</span>)));
                <span class='constant'>this</span>.<span class='field'>pending</span>.<span class='field'>push</span>(task);
            } <span class='keyword'>else</span> <span class='keyword'>if</span> line.<span class='field'>prefix</span>(<span class='string'>"COMPLETED:"</span>) {
                task = Task(line.<span class='field'>slice</span>(<span class='keyword'>len</span>(<span class='string'>"COMPLETED:"</span>)));
                <span class='constant'>this</span>.<span class='field'>completed</span>.<span class='field'>push</span>(task);
            }

            <span class='keyword'>fn</span> <span class='function'>expect</span>(expected) {
                <span class='keyword'>if</span> i &gt;= <span class='keyword'>len</span>(lines) {
                    io.<span class='field'>eprintln</span>(<span class='string'>"Error: corrupted '</span><span class='escape'>\</span><span class='escape'>(</span>path<span class='escape'>)</span><span class='string'>'. Expected '</span><span class='escape'>\</span><span class='escape'>(</span>expected<span class='escape'>)</span><span class='string'>' on line </span><span class='escape'>\</span><span class='escape'>(</span>i + <span class='constant'>1</span><span class='escape'>)</span><span class='string'>, got EOF"</span>);
                    os.<span class='field'>exit</span>(<span class='constant'>1</span>);
                }

                line = lines[i]; i += <span class='constant'>1</span>;
                <span class='keyword'>if</span> !line.<span class='field'>prefix</span>(expected) {
                    io.<span class='field'>eprintln</span>(<span class='string'>"Error: corrupted '</span><span class='escape'>\</span><span class='escape'>(</span>path<span class='escape'>)</span><span class='string'>'. Expected '</span><span class='escape'>\</span><span class='escape'>(</span>expected<span class='escape'>)</span><span class='string'>' on line </span><span class='escape'>\</span><span class='escape'>(</span>i + <span class='constant'>1</span><span class='escape'>)</span><span class='string'>, got '</span><span class='escape'>\</span><span class='escape'>(</span>line<span class='escape'>)</span><span class='string'>'"</span>);
                    os.<span class='field'>exit</span>(<span class='constant'>1</span>);
                }
            }

            expect(<span class='string'>"DUE:"</span>);
            task.<span class='field'>set_due</span>(line.<span class='field'>slice</span>(<span class='keyword'>len</span>(<span class='string'>"DUE:"</span>)));

            expect(<span class='string'>"TAGS:"</span>);
            task.<span class='field'>set_tag</span>(line.<span class='field'>slice</span>(<span class='keyword'>len</span>(<span class='string'>"TAGS:"</span>)));

            expect(<span class='string'>"PRIORITY:"</span>);
            task.<span class='field'>set_priority</span>(line.<span class='field'>slice</span>(<span class='keyword'>len</span>(<span class='string'>"PRIORITY:"</span>)));
        }

        f.<span class='field'>close</span>();
    }

    add(title, flags) {
        <span class='keyword'>var</span> task = Task(title);

        <span class='keyword'>if</span> <span class='string'>"due"</span> <span class='keyword'>in</span> flags {
            task.<span class='field'>set_due</span>(flags.<span class='field'>due</span>);
        }

        <span class='keyword'>if</span> <span class='string'>"tag"</span> <span class='keyword'>in</span> flags {
            task.<span class='field'>set_tag</span>(flags.<span class='field'>tag</span>);
        }

        <span class='keyword'>if</span> <span class='string'>"priority"</span> <span class='keyword'>in</span> flags {
            task.<span class='field'>set_priority</span>(flags.<span class='field'>priority</span>);
        }

        <span class='constant'>this</span>.<span class='field'>pending</span>.<span class='field'>push</span>(task);
        io.<span class='field'>println</span>(<span class='string'>"Added: </span><span class='escape'>\</span><span class='escape'>(</span>task.<span class='field'>show</span>()<span class='escape'>)</span><span class='string'>"</span>);
    }

    list(flags) {
        <span class='keyword'>var</span> pending = <span class='constant'>false</span>;

        <span class='keyword'>var</span> match = Task(<span class='string'>""</span>);
        <span class='keyword'>if</span> <span class='string'>"due"</span> <span class='keyword'>in</span> flags {
            match.<span class='field'>set_due</span>(flags.<span class='field'>due</span>);
        }

        <span class='keyword'>if</span> <span class='string'>"tag"</span> <span class='keyword'>in</span> flags {
            match.<span class='field'>set_tag</span>(flags.<span class='field'>tag</span>);
        }

        <span class='keyword'>if</span> <span class='string'>"priority"</span> <span class='keyword'>in</span> flags {
            match.<span class='field'>set_priority</span>(flags.<span class='field'>priority</span>);
        }

        <span class='keyword'>fn</span> <span class='function'>skip</span>(task) {
            <span class='keyword'>if</span> <span class='string'>"due"</span> <span class='keyword'>in</span> flags &amp;&amp; (!task.<span class='field'>due</span> || !task.<span class='field'>due</span>.<span class='field'>equal</span>(match.<span class='field'>due</span>)) {
                <span class='keyword'>return</span> <span class='constant'>true</span>;
            }

            <span class='keyword'>if</span> <span class='string'>"tag"</span> <span class='keyword'>in</span> flags {
                <span class='keyword'>for</span> _, tag <span class='keyword'>in</span> match.<span class='field'>tags</span> {
                    <span class='keyword'>if</span> !task.<span class='field'>tags</span>.<span class='field'>find</span>(tag) {
                        <span class='keyword'>return</span> <span class='constant'>true</span>;
                    }
                }
            }

            <span class='keyword'>if</span> <span class='string'>"priority"</span> <span class='keyword'>in</span> flags &amp;&amp; task.<span class='field'>priority</span> != match.<span class='field'>priority</span> {
                <span class='keyword'>return</span> <span class='constant'>true</span>;
            }

            <span class='keyword'>return</span> <span class='constant'>false</span>;
        }

        <span class='keyword'>for</span> i, t <span class='keyword'>in</span> <span class='constant'>this</span>.<span class='field'>pending</span> {
            <span class='keyword'>if</span> skip(t) {
                <span class='keyword'>continue</span>;
            }

            <span class='keyword'>if</span> !pending {
                pending = <span class='constant'>true</span>;
                io.<span class='field'>println</span>(<span class='string'>"Pending Tasks:"</span>);
            }

            io.<span class='field'>println</span>(<span class='string'>"[</span><span class='escape'>\</span><span class='escape'>(</span>i<span class='escape'>)</span><span class='string'>]"</span>, t.<span class='field'>show</span>());
        }

        <span class='keyword'>var</span> completed = <span class='constant'>false</span>;

        <span class='keyword'>for</span> i, t <span class='keyword'>in</span> <span class='constant'>this</span>.<span class='field'>completed</span> {
            <span class='keyword'>if</span> skip(t) {
                <span class='keyword'>continue</span>;
            }

            <span class='keyword'>if</span> !completed {
                completed = <span class='constant'>true</span>;

                <span class='keyword'>if</span> pending {
                    io.<span class='field'>println</span>();
                }
                io.<span class='field'>println</span>(<span class='string'>"Completed Tasks:"</span>);
            }

            io.<span class='field'>println</span>(<span class='string'>"[</span><span class='escape'>\</span><span class='escape'>(</span>i<span class='escape'>)</span><span class='string'>]"</span>, t.<span class='field'>show</span>());
        }
    }

    done(index) {
        <span class='keyword'>if</span> index &gt;= <span class='keyword'>len</span>(<span class='constant'>this</span>.<span class='field'>pending</span>) {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid task index '</span><span class='escape'>\</span><span class='escape'>(</span>index<span class='escape'>)</span><span class='string'>'"</span>);
            currently(<span class='keyword'>len</span>(<span class='constant'>this</span>.<span class='field'>pending</span>), <span class='string'>"pending task"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> task = <span class='constant'>this</span>.<span class='field'>pending</span>.<span class='field'>remove</span>(index);
        <span class='constant'>this</span>.<span class='field'>completed</span>.<span class='field'>push</span>(task);

        io.<span class='field'>println</span>(<span class='string'>"Completed: </span><span class='escape'>\</span><span class='escape'>(</span>task.<span class='field'>show</span>()<span class='escape'>)</span><span class='string'>"</span>);
    }

    remove(index) {
        <span class='keyword'>if</span> index &gt;= <span class='keyword'>len</span>(<span class='constant'>this</span>.<span class='field'>completed</span>) {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid task index '</span><span class='escape'>\</span><span class='escape'>(</span>index<span class='escape'>)</span><span class='string'>'"</span>);
            currently(<span class='keyword'>len</span>(<span class='constant'>this</span>.<span class='field'>completed</span>), <span class='string'>"completed task"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> task = <span class='constant'>this</span>.<span class='field'>completed</span>.<span class='field'>remove</span>(index);
        io.<span class='field'>println</span>(<span class='string'>"Removed: </span><span class='escape'>\</span><span class='escape'>(</span>task.<span class='field'>show</span>()<span class='escape'>)</span><span class='string'>"</span>);
    }

    search(query) {
        <span class='keyword'>var</span> pending = <span class='constant'>false</span>;

        <span class='keyword'>for</span> i, t <span class='keyword'>in</span> <span class='constant'>this</span>.<span class='field'>pending</span> {
            <span class='keyword'>if</span> !t.<span class='field'>title</span>.<span class='field'>find</span>(query) {
                <span class='keyword'>continue</span>;
            }

            <span class='keyword'>if</span> !pending {
                pending = <span class='constant'>true</span>;
                io.<span class='field'>println</span>(<span class='string'>"Pending Tasks:"</span>);
            }

            io.<span class='field'>println</span>(<span class='string'>"[</span><span class='escape'>\</span><span class='escape'>(</span>i<span class='escape'>)</span><span class='string'>]"</span>, t.<span class='field'>show</span>());
        }

        <span class='keyword'>var</span> completed = <span class='constant'>false</span>;

        <span class='keyword'>for</span> i, t <span class='keyword'>in</span> <span class='constant'>this</span>.<span class='field'>completed</span> {
            <span class='keyword'>if</span> !t.<span class='field'>title</span>.<span class='field'>find</span>(query) {
                <span class='keyword'>continue</span>;
            }

            <span class='keyword'>if</span> !completed {
                completed = <span class='constant'>true</span>;

                <span class='keyword'>if</span> pending {
                    io.<span class='field'>println</span>();
                }
                io.<span class='field'>println</span>(<span class='string'>"Completed Tasks:"</span>);
            }

            io.<span class='field'>println</span>(<span class='string'>"[</span><span class='escape'>\</span><span class='escape'>(</span>i<span class='escape'>)</span><span class='string'>]"</span>, t.<span class='field'>show</span>());
        }
    }

    save() {
        <span class='keyword'>var</span> f = io.<span class='field'>Writer</span>(<span class='constant'>this</span>.<span class='field'>path</span>);
        <span class='keyword'>if</span> !f {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: could not save tasks to file '</span><span class='escape'>\</span><span class='escape'>(</span><span class='constant'>this</span>.<span class='field'>path</span><span class='escape'>)</span><span class='string'>'"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> i = <span class='constant'>0</span>;
        <span class='keyword'>fn</span> <span class='function'>save</span>(task, prefix) {
            f.<span class='field'>writeln</span>(<span class='string'>"</span><span class='escape'>\</span><span class='escape'>(</span>prefix<span class='escape'>)</span><span class='string'>:</span><span class='escape'>\</span><span class='escape'>(</span>task.<span class='field'>title</span><span class='escape'>)</span><span class='string'>"</span>);
            f.<span class='field'>writeln</span>(<span class='string'>"DUE:</span><span class='escape'>\</span><span class='escape'>(</span>date(task.<span class='field'>due</span>)<span class='escape'>)</span><span class='string'>"</span>);
            f.<span class='field'>writeln</span>(<span class='string'>"TAGS:</span><span class='escape'>\</span><span class='escape'>(</span>task.<span class='field'>tags</span>.<span class='field'>join</span>(<span class='string'>","</span>)<span class='escape'>)</span><span class='string'>"</span>);
            f.<span class='field'>writeln</span>(<span class='string'>"PRIORITY:</span><span class='escape'>\</span><span class='escape'>(</span>PRIORITIES[task.<span class='field'>priority</span>]<span class='escape'>)</span><span class='string'>"</span>);
        }

        i = <span class='constant'>0</span>;
        <span class='keyword'>while</span> i &lt; <span class='keyword'>len</span>(<span class='constant'>this</span>.<span class='field'>pending</span>) {
            <span class='keyword'>var</span> task = <span class='constant'>this</span>.<span class='field'>pending</span>[i]; i += <span class='constant'>1</span>;
            save(task, <span class='string'>"PENDING"</span>);
        }

        i = <span class='constant'>0</span>;
        <span class='keyword'>while</span> i &lt; <span class='keyword'>len</span>(<span class='constant'>this</span>.<span class='field'>completed</span>) {
            <span class='keyword'>var</span> task = <span class='constant'>this</span>.<span class='field'>completed</span>[i]; i += <span class='constant'>1</span>;
            save(task, <span class='string'>"COMPLETED"</span>);
        }

        f.<span class='field'>close</span>();
    }
}

<span class='keyword'>if</span> <span class='constant'>is_main_module</span> {
    <span class='keyword'>var</span> tasks = Tasks(TASKS_PATH);

    <span class='keyword'>if</span> <span class='keyword'>len</span>(os.<span class='field'>args</span>) &lt; <span class='constant'>2</span> {
        io.<span class='field'>eprintln</span>(<span class='string'>"Error: command not provided"</span>);
        io.<span class='field'>eprintln</span>(<span class='string'>"Usage: </span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>0</span>]<span class='escape'>)</span><span class='string'> &lt;command&gt; [args...]"</span>);
        io.<span class='field'>eprintln</span>(<span class='string'>"Commands:"</span>);
        io.<span class='field'>eprintln</span>(<span class='string'>"    add"</span>);
        io.<span class='field'>eprintln</span>(<span class='string'>"    list"</span>);
        io.<span class='field'>eprintln</span>(<span class='string'>"    done"</span>);
        io.<span class='field'>eprintln</span>(<span class='string'>"    remove"</span>);
        io.<span class='field'>eprintln</span>(<span class='string'>"    search"</span>);
        os.<span class='field'>exit</span>(<span class='constant'>1</span>);
    }
    <span class='keyword'>var</span> command = os.<span class='field'>args</span>[<span class='constant'>1</span>];

    <span class='keyword'>if</span> command == <span class='string'>"add"</span> {
        <span class='keyword'>if</span> <span class='keyword'>len</span>(os.<span class='field'>args</span>) &lt; <span class='constant'>3</span> {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: task title not provided"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"Usage: </span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>0</span>]<span class='escape'>)</span><span class='string'> add &lt;title&gt; [flags...]"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        tasks.<span class='field'>add</span>(os.<span class='field'>args</span>[<span class='constant'>2</span>], flags(<span class='constant'>3</span>, FLAGS));
        tasks.<span class='field'>save</span>();
        <span class='keyword'>return</span>;
    }

    <span class='keyword'>if</span> command == <span class='string'>"list"</span> {
        tasks.<span class='field'>list</span>(flags(<span class='constant'>2</span>, FLAGS));
        <span class='keyword'>return</span>;
    }

    <span class='keyword'>if</span> command == <span class='string'>"done"</span> {
        <span class='keyword'>if</span> <span class='keyword'>len</span>(os.<span class='field'>args</span>) &lt; <span class='constant'>3</span> {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: task index not provided"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"Usage: </span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>0</span>]<span class='escape'>)</span><span class='string'> done &lt;index&gt;"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> index = os.<span class='field'>args</span>[<span class='constant'>2</span>].<span class='field'>tonumber</span>();
        <span class='keyword'>if</span> !index {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid task index '</span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>2</span>]<span class='escape'>)</span><span class='string'>'"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        tasks.<span class='field'>done</span>(index);
        tasks.<span class='field'>save</span>();
        <span class='keyword'>return</span>;
    }

    <span class='keyword'>if</span> command == <span class='string'>"remove"</span> {
        <span class='keyword'>if</span> <span class='keyword'>len</span>(os.<span class='field'>args</span>) &lt; <span class='constant'>3</span> {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: task index not provided"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"Usage: </span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>0</span>]<span class='escape'>)</span><span class='string'> remove &lt;index&gt;"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> index = os.<span class='field'>args</span>[<span class='constant'>2</span>].<span class='field'>tonumber</span>();
        <span class='keyword'>if</span> !index {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid task index '</span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>2</span>]<span class='escape'>)</span><span class='string'>'"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        tasks.<span class='field'>remove</span>(index);
        tasks.<span class='field'>save</span>();
        <span class='keyword'>return</span>;
    }

    <span class='keyword'>if</span> command == <span class='string'>"search"</span> {
        <span class='keyword'>if</span> <span class='keyword'>len</span>(os.<span class='field'>args</span>) &lt; <span class='constant'>3</span> {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: search query not provided"</span>);
            io.<span class='field'>eprintln</span>(<span class='string'>"Usage: </span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>0</span>]<span class='escape'>)</span><span class='string'> search &lt;query&gt;"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        <span class='keyword'>var</span> query = Regex(os.<span class='field'>args</span>[<span class='constant'>2</span>]);
        <span class='keyword'>if</span> !query {
            io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid search query '</span><span class='escape'>\</span><span class='escape'>(</span>os.<span class='field'>args</span>[<span class='constant'>2</span>]<span class='escape'>)</span><span class='string'>'"</span>);
            os.<span class='field'>exit</span>(<span class='constant'>1</span>);
        }

        tasks.<span class='field'>search</span>(query);
        <span class='keyword'>return</span>;
    }

    io.<span class='field'>eprintln</span>(<span class='string'>"Error: invalid command '</span><span class='escape'>\</span><span class='escape'>(</span>command<span class='escape'>)</span><span class='string'>'"</span>);
    io.<span class='field'>eprintln</span>(<span class='string'>"Available commands:"</span>);
    io.<span class='field'>eprintln</span>(<span class='string'>"    add"</span>);
    io.<span class='field'>eprintln</span>(<span class='string'>"    list"</span>);
    io.<span class='field'>eprintln</span>(<span class='string'>"    done"</span>);
    io.<span class='field'>eprintln</span>(<span class='string'>"    remove"</span>);
    io.<span class='field'>eprintln</span>(<span class='string'>"    search"</span>);
    os.<span class='field'>exit</span>(<span class='constant'>1</span>);
}
</pre>
</pre>
</div>
<div class='codes'>
<button class='copy' onclick='copyClick(this)'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z'></path><path d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z'></path>
</svg>
</button>
<button class='copied hidden'>
<svg height='16' viewBox='0 0 16 16' version='1.1' width='16'>
    <path d='M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'></path>
</svg>
</button>
<pre class='code active'>
<span class='comment'># Adding a new task (Default priority is medium)</span>
<span class='constant'>$ </span>bs tasks.bs add "Finish reading book"
Added: Finish reading book [Priority: medium]

<span class='comment'># Adding a task with a high priority and tag</span>
<span class='constant'>$ </span>bs tasks.bs add "Submit project report" -due "2024-10-22" -priority high -tag work
Added: Submit project report (Due: 2024-10-22) [Priority: high] [Tags: work]

<span class='comment'># Listing all tasks</span>
<span class='constant'>$ </span>bs tasks.bs list
Pending Tasks:
[0] Finish reading book [Priority: medium]
[1] Submit project report (Due: 2024-10-22) [Priority: high] [Tags: work]

<span class='comment'># Marking a task as complete</span>
<span class='constant'>$ </span>bs tasks.bs done 1
Completed: Submit project report (Due: 2024-10-22) [Priority: high] [Tags: work]

<span class='comment'># Listing all tasks</span>
<span class='constant'>$ </span>bs tasks.bs list
Pending Tasks:
[0] Finish reading book [Priority: medium]

Completed Tasks:
[0] Submit project report (Due: 2024-10-22) [Priority: high] [Tags: work]

<span class='comment'># Filtering tasks by tag</span>
<span class='constant'>$ </span>bs tasks.bs list -tag work
Completed Tasks:
[0] Submit project report (Due: 2024-10-22) [Priority: high] [Tags: work]

<span class='comment'># Remove a completed task</span>
<span class='constant'>$ </span>bs tasks.bs remove 0
Removed: Submit project report (Due: 2024-10-22) [Priority: high] [Tags: work]

<span class='constant'>$ </span>bs tasks.bs add Finish
Added: Finish [Priority: medium]

<span class='constant'>$ </span>bs tasks.bs add foo
Added: foo [Priority: medium]

<span class='constant'>$ </span>bs tasks.bs add bar
Added: bar [Priority: medium]

<span class='constant'>$ </span>bs tasks.bs done 2
Completed: Finish [Priority: medium]

<span class='comment'># Search content of tasks using Regex</span>
<span class='constant'>$ </span>bs tasks.bs search '[fF]'
Pending Tasks:
[0] Finish reading book [Priority: medium]
[1] foo [Priority: medium]

Completed Tasks:
[0] Finish [Priority: medium]
</pre>
</div>
</section>
</main>
<nav id='sidebar' class='collapsed'>
<ul>
<li>
<a href='#s0'> <code>cat</code></a>
</li>
<li>
<a href='#s1'> <code>grep</code></a>
</li>
<li>
<a href='#s2'> Shell</a>
</li>
<li>
<a href='#s3'> Rule110</a>
</li>
<li>
<a href='#s4'> Game Of Life</a>
<ul>
<li>
<a href='#s5'> Console</a>
</li>
<li>
<a href='#s6'> Raylib</a>
</li>
</ul>
</li>
<li>
<a href='#s7'> CLI Task Management APP</a>
</li>
</ul>
</nav>
<script src='script.js'></script>
</body>
</html>
